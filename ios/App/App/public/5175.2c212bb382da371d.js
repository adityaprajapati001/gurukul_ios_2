"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5175],{3248:(_,h,n)=>{n.d(h,{V:()=>o});const o=(0,n(2726).fo)("PushNotifications",{})},5175:(_,h,n)=>{n.d(h,{e:()=>i});var u=n(5861),o=n(9862),c=n(553),m=n(3248),d=n(9212),l=n(2359),g=n(7568);const s=c.N.baseUrl;new o.WM({"Content-Type":"application/x-www-form-urlencoded","X-Custom-Header":"application/json","Access-Control-Allow-Headers":"Content-Type,Access-Control-Allow-Headers,lang","Access-Control-Allow-Origin":"*"});let i=(()=>{class p{constructor(t,e,r){this.http=t,this.tokenService=e,this.fcmService=r,this.fcmToken="",this.token=this.tokenService.getToken()}initPushNotifications(){this.fcmService.getNewUserInfo().subscribe(t=>{this.fcmToken=t,console.log("02222222222222222222222222222222222222222222222222220222222@@@@@@@@@@",this.fcmToken)})}login(t,e){let r=(new o.LE).set("username",t).set("password",e);return console.log(r),this.http.get(s+"login/token.php?service=moodle_mobile_app",{params:r})}validateEmail(t){let e=(new o.LE).set("values[0]",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wstoken=${this.tokenService.getAdminToken()}&wsfunction=core_user_get_users_by_field&field=email`,{params:e})}sendOtp(t){const e=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),r=new URLSearchParams({task:"sendotp",phone:t}).toString();return this.http.post(s+"webservice/rest/api.php",r,{headers:e})}loginViaOtp(t,e){const r=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=new URLSearchParams({task:"verifyopt",phone:t,votpid:e}).toString();return this.http.post(s+"webservice/rest/api.php",a,{headers:r})}expireOtp(t){const e=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),r=new URLSearchParams({task:"expiredOTP",phone:t}).toString();return this.http.post(s+"webservice/rest/api.php",r,{headers:e})}forgotPassword(t){let e=(new o.LE).set("email",t);return console.log(e),this.http.get(`https://gurukul.skfin.in/webservice/rest/server.php?moodlewsrestformat=json&wsfunction=core_auth_request_password_reset&wstoken=${c.N.adminToken}`,{params:e})}getUserInfo(t){let e=(new o.LE).set("values[0]",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wstoken=${c.N.adminToken}&wsfunction=core_user_get_users_by_field&field=username`,{params:e})}getUserInfoByUserId(t){let e=(new o.LE).set("values[0]",t);return this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wstoken=${this.token}&wsfunction=core_user_get_users_by_field&field=id`,{params:e})}getRecentCourses(){return this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=block_recentlyaccesseditems_get_recent_items&wstoken=${this.token}`)}createRecentItems(t,e,r){const a=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),w=Date.now().toString(),k=new URLSearchParams({task:"createRecentItem",cmid:t,token:this.token,userid:e,courseid:r,timeaccess:w}).toString();return this.http.post(s+"webservice/rest/api.php",k,{headers:a})}getRecentCoursesByID(t){const e=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),r=new URLSearchParams({task:"getModuleInstance",cmid:t}).toString();return this.http.post(s+"webservice/rest/api.php",r,{headers:e})}getCourses(t){let e=(new o.LE).set("userid",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=core_enrol_get_users_courses&wstoken=${this.token}`,{params:e})}getCoursesById(t){let e=(new o.LE).set("value",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=core_course_get_courses_by_field&wstoken=${this.token}&field=id`,{params:e})}getCalendarEvent(t,e){let r=(new o.LE).set("year",t).set("month",e);return console.log(r),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=core_calendar_get_calendar_monthly_view&wstoken=${this.token}`,{params:r})}getCourseContent(t){let e=(new o.LE).set("courseid",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=core_course_get_contents&wstoken=${this.token}`,{params:e})}getUserGrades(t,e){let r=(new o.LE).set("userid",t).set("courseid",e);return console.log(r),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=gradereport_user_get_grade_items&wstoken=${this.token}`,{params:r})}getScormsByCourseId(t){let e=(new o.LE).set("courseids[0]",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=mod_scorm_get_scorms_by_courses&wstoken=${this.token}`,{params:e})}isAttemptFinish(t,e){const r=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=new URLSearchParams({task:"isAttemptFinished",userid:t,quiz:e}).toString();return this.http.post(s+"webservice/rest/api.php",a,{headers:r})}isAttemptFinishInstance(t,e){const r=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=new URLSearchParams({task:"isAttemptFinished",userid:t,quiz:e}).toString();return this.http.post(s+"webservice/rest/api.php",a,{headers:r})}getMaxAttemptData(t,e){let r=(new o.LE).set("quizid",t).set("userid",e);return this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=mod_quiz_get_user_attempts&wstoken=${this.token}`,{params:r})}AttemptSummary(){return this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=mod_quiz_get_user_attempts&wstoken=${this.token}&quizid=12`)}getQuizDataNew(t,e){const r=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=new URLSearchParams({task:"quizInfo",courseid:e,quizid:t}).toString();return this.http.post(s+`https://gurukul.skfin.in/webservice/rest/server.php?moodlewsrestformat=json&wsfunction=mod_quiz_get_user_attempts&wstoken=${this.token}&quizid=${t}`,a,{headers:r})}getQuizData(t,e){var r=this;return(0,u.Z)(function*(){const a=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),w=new URLSearchParams({task:"quizInfo",courseid:e,quizid:t}).toString();return r.http.post(s+"webservice/rest/api.php",w,{headers:a}).toPromise()})()}getUserToken(t){const e=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),r=new URLSearchParams({task:"getUserToken",userid:t}).toString();return this.http.post(s+"webservice/rest/api.php",r,{headers:e})}startQuizById(t){let e=(new o.LE).set("quizid",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=mod_quiz_start_attempt&wstoken=${this.token}`,{params:e})}getAttemptSummary(t){let e=(new o.LE).set("attemptid",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=mod_quiz_get_attempt_summary&wstoken=${this.token}`,{params:e})}getNotificationByUserId(t){let e=(new o.LE).set("useridto",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=message_popup_get_popup_notifications&wstoken=${this.token}`,{params:e})}getGradesByUserId(t){let e=(new o.LE).set("userid",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=gradereport_overview_get_course_grades&wstoken=${this.token}`,{params:e})}getBadgesByUserId(t){let e=(new o.LE).set("userid",t);return console.log(e),this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=core_badges_get_user_badges&wstoken=${this.token}`,{params:e})}getTickerContent(){const t=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),e=new URLSearchParams({task:"getTickerContent"}).toString();return this.http.post(s+"webservice/rest/api.php",e,{headers:t})}fetchHtmlContent(t){var e=this;return(0,u.Z)(function*(){try{return e.http.get(t,{responseType:"text"}).toPromise()}catch(r){throw Error(r)}})()}updateFcmToken(){var t=this;return(0,u.Z)(function*(){try{return m.V.addListener("registration",function(){var e=(0,u.Z)(function*(r){if(console.log("Push registration succes, token: "+r.value),t.fcmToken=r.value,console.log("getUserDetailsFromLocal",t.getUserDetailsFromLocal()),r.value){const a=new URLSearchParams({task:"fcmTokenGenrate",userid:t.getUserDetailsFromLocal()[0].id,fcmToken:t.fcmToken}).toString(),w=new o.WM({"Content-Type":"application/x-www-form-urlencoded"});yield t.http.post(s+"webservice/rest/api.php",a,{headers:w}).toPromise()}});return function(r){return e.apply(this,arguments)}}())}catch(e){throw console.log(e),Error(e)}})()}getUserDetailsFromLocal(){return JSON.parse(localStorage.getItem("auth-user"))}checkFeedbackFormStatus(t){const e=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),r=new URLSearchParams({task:"QuizefeedbackSubmit",userid:this.getUserDetailsFromLocal()[0].id,feedbackid:t,feedbackAns:"[]",status:"load"}).toString();return this.http.post(s+"webservice/rest/api.php",r,{headers:e})}submitFeedback(t,e,r){const a=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),w=new URLSearchParams({task:"QuizefeedbackSubmit",userid:this.getUserDetailsFromLocal()[0].id,feedbackid:t,feedbackAns:e,status:r}).toString();return this.http.post(s+"webservice/rest/api.php",w,{headers:a})}getFeedbackItems(t,e){return this.http.get(s+`webservice/rest/server.php?moodlewsrestformat=json&wsfunction=mod_feedback_get_items&wstoken=${this.token}&courseid=${t}&feedbackid=${e}`)}getImg(){const t=new o.WM({"Content-Type":"application/x-www-form-urlencoded"}),e=new URLSearchParams({task:"QuizefeedbackSubmit"}).toString();return this.http.post(s+"webservice/rest/api.php",e,{headers:t})}static#e=this.\u0275fac=function(e){return new(e||p)(d.LFG(o.eN),d.LFG(l.B),d.LFG(g.E))};static#t=this.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()},7568:(_,h,n)=>{n.d(h,{E:()=>g});var u=n(5861),o=n(9862),c=n(3248),m=n(5619),d=n(553),l=n(9212);let g=(()=>{class s{constructor(i){this.http=i,this.newToken=new m.X({deviceToken:void 0})}fcm(){c.V.requestPermissions().then(i=>{"granted"===i.receive&&c.V.register()}),c.V.addListener("registration",i=>{console.log("Push registration success, token: "+i.value),i.value&&this.setNewUserInfo(i.value)}),c.V.addListener("registrationError",i=>{}),c.V.addListener("pushNotificationReceived",i=>{}),c.V.addListener("pushNotificationActionPerformed",i=>{})}setNewUserInfo(i){this.newToken.next(i)}getNewUserInfo(){return this.newToken.asObservable()}sendPushNotification(){var i=this;return(0,u.Z)(function*(){try{const p=new o.WM({Authorization:`key=${d.N.firebaseFCMServerKey}`,"Content-Type":"application/json"});let v="https://fcm.googleapis.com/fcm/send",t={to:"d9B4YlciSyW2VHfMHs6497:APA91bGhi09Yw__xXxZfXwP1E4y6Iann5adEnZCvi6tOpeDcGVV87A42E4h0R-OgNO_M7z1Vuhg2OB0yBSFYCHxoA5UDSF4SNQ53YGMr3Nt9k7XGvLRDCX0-xO1jGTi9QsgoF-bLi9dJ",notification:{title:"Check this Mobile (title)",body:"Rich Notification testing (body)",icon:"https://cdn-icons-png.flaticon.com/256/15094/15094822.png",sound:"default"},data:{image:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcREBuBZSySbBnaUW2zeJzQopgUWQjDyy_LUsv23zcq67Q&s",meta:{type:"small",info:"Search"}}};yield i.http.post(v,JSON.stringify(t),{headers:p}).toPromise()}catch(p){console.log(p)}})()}static#e=this.\u0275fac=function(p){return new(p||s)(l.LFG(o.eN))};static#t=this.\u0275prov=l.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},2359:(_,h,n)=>{n.d(h,{B:()=>d});var u=n(9212);const o="auth-token",c="auth-user",m="admin-token";let d=(()=>{class l{constructor(){}getAdminToken(){return localStorage.getItem(m)}saveAdminToken(s){localStorage.removeItem(m),localStorage.setItem(m,s)}saveToken(s){localStorage.removeItem(o),localStorage.setItem(o,s)}getToken(){return localStorage.getItem(o)}removeToken(){localStorage.removeItem(o)}saveUser(s){localStorage.removeItem(c),localStorage.setItem(c,JSON.stringify(s))}getUser(){const s=window.localStorage.getItem(c);return s?JSON.parse(s):{}}logOut(){localStorage.removeItem("username"),localStorage.removeItem("auth-user"),localStorage.removeItem("auth-token"),localStorage.removeItem("first_time_refresh")}static#e=this.\u0275fac=function(f){return new(f||l)};static#t=this.\u0275prov=u.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})()}}]);