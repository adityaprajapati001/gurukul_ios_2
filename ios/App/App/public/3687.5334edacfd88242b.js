"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3687],{3687:(I,b,u)=>{u.r(b),u.d(b,{LoginPageModule:()=>F});var p=u(6814),l=u(95),c=u(3134),f=u(4875),m=u(5861),_=u(4825),e=u(9212),T=u(5175),w=u(2359),P=u(7568);function Z(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"div",15)(1,"form",16),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onSubmit())}),e.TgZ(2,"div",17)(3,"label",18),e._UZ(4,"span",19),e._uU(5,"User ID"),e.qZA(),e.TgZ(6,"div",20),e._UZ(7,"ion-img",21)(8,"input",22),e.qZA(),e._UZ(9,"hr",23),e.qZA(),e.TgZ(10,"div",17)(11,"label",24),e._UZ(12,"span",19),e._uU(13,"Password"),e.qZA(),e.TgZ(14,"div",20),e._UZ(15,"ion-img",25)(16,"input",26),e.TgZ(17,"ion-icon",27),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.showPassword=!n.showPassword)}),e.qZA()(),e._UZ(18,"hr",23),e.qZA(),e.TgZ(19,"div",28)(20,"div")(21,"ion-checkbox",29),e._uU(22,"Remember Me"),e.qZA(),e.TgZ(23,"p",30),e._uU(24," Forgot Password ? "),e.qZA()(),e.TgZ(25,"ion-button",31)(26,"span",32),e._uU(27,"Sign In"),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(),e.Q6J("formGroup",t.loginForm),e.xp6(15),e.Q6J("type",t.showPassword?"text":"password"),e.xp6(),e.Q6J("name",t.showPassword?"eye-outline":"eye-off-outline"),e.xp6(8),e.Q6J("disabled",t.loginForm.invalid)}}function x(i,h){1&i&&e._UZ(0,"ion-icon",43)}function y(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"p",44),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.resendOtp())}),e._uU(1," Resent OTP? "),e.qZA()}}const C=i=>({color:i});function S(i,h){if(1&i&&(e.TgZ(0,"p",45),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.Q6J("ngStyle",e.VKq(2,C,t.timerColor)),e.xp6(),e.hij(" 00:",t.remainingTime," ")}}function O(i,h){if(1&i){const t=e.EpF();e.TgZ(0,"div",15)(1,"form",16),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onSubmitOtp())}),e.TgZ(2,"div",17)(3,"label",33),e._uU(4,"Mobile Number"),e.qZA(),e.TgZ(5,"div",20),e._UZ(6,"ion-img",34),e.TgZ(7,"input",35),e.NdJ("input",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onMaxPhone(n))}),e.qZA(),e.YNc(8,x,1,0,"ion-icon",36),e.qZA(),e._UZ(9,"hr",23),e.qZA(),e.TgZ(10,"div",17)(11,"label",37),e._uU(12,"OTP"),e.qZA(),e.TgZ(13,"div",20),e._UZ(14,"ion-img",38)(15,"input",39),e.qZA(),e._UZ(16,"hr",23),e.qZA(),e.TgZ(17,"div",28),e.YNc(18,y,2,0,"p",40)(19,S,2,4,"p",41),e.TgZ(20,"ion-button",42)(21,"span",32),e._uU(22,"Sign In"),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(),e.Q6J("formGroup",t.otpLoginForm),e.xp6(7),e.Q6J("ngIf",t.isPhoneValid()),e.xp6(10),e.Q6J("ngIf",!t.isVisible),e.xp6(),e.Q6J("ngIf",t.isVisible),e.xp6(),e.Q6J("disabled",t.otpLoginForm.invalid)}}const M=[{path:"",component:(()=>{class i{constructor(t,o,n,r,s,a,d,g){this.router=t,this.fb=o,this.authService=n,this.tokenService=r,this.toastCtrl=s,this.loadingController=a,this.fcmService=d,this.cdr=g,this.isLoggedIn=!1,this.showPassword=!1,this.passwordToggleIcon="eye-off-outline",this.isVisible=!1,this.remainingTime=30,this.timerColor="#3553A1",this.segment="user",this.userData=[]}ngOnInit(){console.log("rememberMeData",localStorage.getItem("rememberMeData")),this.createUserForm(),this.createOtpForm()}createUserForm(){this.loginForm=this.fb.group({username:["",[l.kI.required]],password:["",[l.kI.required]],rememberMe:[!1]});const t=localStorage.getItem("rememberMeData");if(null!==t){const o=JSON.parse(t);this.loginForm.patchValue(o)}}createOtpForm(){this.otpLoginForm=this.fb.group({phone:["",[l.kI.required]],otp:["",[l.kI.required]]})}get f(){return this.loginForm.controls}get g(){return this.otpLoginForm.controls}toggle(){this.showPassword=!this.showPassword,this.passwordToggleIcon=this.showPassword?"eye-outline":"eye-off-outline"}changeForm(t){var o=this;return(0,m.Z)(function*(){const n=yield o.loadingController.create({message:"Loading...",duration:2e3});yield n.present(),yield n.dismiss()})()}onSubmit(){var t=this;return(0,m.Z)(function*(){t.isLoggedIn=!0;const o=yield t.loadingController.create({duration:2e3});var n;t.loginForm.valid&&t.authService.getUserInfo(t.loginForm.get("username")?.value).subscribe({next:(n=(0,m.Z)(function*(r){if(r){console.log("userinfo",r),yield o.present();const s=t.loginForm.get("username")?.value,a=t.loginForm.get("password")?.value;t.authService.login(s,a).subscribe({next:(d=(0,m.Z)(function*(g){if(t.tokenService.saveAdminToken(g?.token),console.log("login res",g),g.error&&(yield o.dismiss(),console.log(r),0!==r.length?parseInt(r[0].username)===parseInt(s)&&t.presentToast("Invalid User ID or Password","danger"):t.presentToast(g.error,"danger")),g.token&&void 0!==g.token){t.tokenService.saveToken(g.token),t.loginForm.value.rememberMe?localStorage.setItem("rememberMeData",JSON.stringify(t.loginForm.value)):localStorage.removeItem("rememberMeData"),localStorage.setItem("username",s),t.tokenService.saveUser(r),t.fcmService.fcm();const v=yield t.authService.updateFcmToken();console.log("fcmRes",v),setTimeout(()=>{t.router.navigate(["home"])},300),yield o.dismiss()}}),function(v){return d.apply(this,arguments)}),error:function(){var d=(0,m.Z)(function*(g){yield o.dismiss(),t.presentToast(g,"danger"),console.error("Login failed:",g)});return function(v){return d.apply(this,arguments)}}(),complete:()=>{}})}var d}),function(s){return n.apply(this,arguments)}),error:n=>{console.error("Error occurred:",n),t.presentToast(n,"danger")}})})()}onSubmitOtp(){var t=this;return(0,m.Z)(function*(){t.isLoggedIn=!0;const o=yield t.loadingController.create({duration:2e3});if(t.otpLoginForm.valid){yield o.present();const n=t.otpLoginForm.get("phone")?.value,r=t.otpLoginForm.get("otp")?.value;t.authService.loginViaOtp(n,r).subscribe({next:(s=(0,m.Z)(function*(a){if(console.log(a),"error"===a.result&&t.presentToast(a.result,"danger"),"success"===a.result){t.tokenService.saveToken(a[0].token),localStorage.setItem("username",a[0].username),console.log("otp user",a),t.tokenService.saveUser(a[0]),t.fcmService.fcm();const d=yield t.authService.updateFcmToken();console.log("fcm res",d),setTimeout(()=>{t.router.navigate(["home"])},300),yield o.dismiss()}}),function(d){return s.apply(this,arguments)}),error:function(){var s=(0,m.Z)(function*(a){yield o.dismiss(),t.presentToast(a,"danger"),console.error("Login failed:",a)});return function(d){return s.apply(this,arguments)}}(),complete:()=>{}})}var s})()}onMaxPhone(t){this.inputValue=t.target.value,this.inputValue.length>10&&(t.target.value=this.inputValue.slice(0,10),this.otpLoginForm.patchValue({phone:this.inputValue.slice(0,10)})),console.log(this.inputValue.length),10===this.inputValue.length&&this.authService.sendOtp(this.otpLoginForm.get("phone")?.value).subscribe(n=>{if("success"===n.result){this.presentToast("OTP Sent Successfully","success");const r=(0,_.H)(0,1e3);this.timerSubscription=r.subscribe(()=>{this.isVisible=!0,this.remainingTime>0?(this.remainingTime--,this.remainingTime<=10&&(this.timerColor="#B80000"),0==this.remainingTime&&this.authService.expireOtp(this.otpLoginForm.get("phone")?.value).subscribe({next:s=>{"error"===s.result&&this.presentToast(s.result,"danger"),"success"===s.result&&this.presentToast("Otp Expired, Please Try Again","danger")},error:s=>{this.presentToast(s,"danger"),console.error("Login failed:",s)}})):(this.isVisible=!1,this.timerSubscription.unsubscribe(),this.remainingTime=30)})}else this.presentToast("OTP Sending Failed","danger")},n=>{console.error("Error occurred:",n),this.presentToast(n,"danger")})}isPhoneValid(){return 10===this.otpLoginForm.get("phone")?.value.toString().length}resendOtp(){console.log(this.inputValue),10===this.inputValue.length&&this.authService.sendOtp(this.otpLoginForm.get("phone")?.value).subscribe(t=>{if("success"===t.result){this.presentToast("OTP Sent Successfully","success");const o=(0,_.H)(0,1e3);this.timerSubscription=o.subscribe(()=>{this.isVisible=!0,this.remainingTime>0?(this.remainingTime--,this.remainingTime<=10&&(this.timerColor="#B80000"),this.remainingTime<=0&&this.authService.expireOtp(this.otpLoginForm.get("phone")?.value).subscribe({next:n=>{"error"===n.result&&this.presentToast(n.result,"danger"),"success"===n.result&&this.presentToast("Otp Expired, Please Try Again","danger")},error:n=>{this.presentToast(n,"danger"),console.error("Login failed:",n)}})):(this.isVisible=!1,this.timerSubscription.unsubscribe())})}else this.presentToast("OTP Sending Failed","danger")},t=>{console.error("Error occurred:",t),this.presentToast(t,"danger")})}presentToast(t,o){var n=this;return(0,m.Z)(function*(){(yield n.toastCtrl.create({message:t,duration:1500,position:"top",color:o})).present()})()}ionViewDidLeave(){this.timerSubscription&&(this.timerSubscription.unsubscribe(),this.remainingTime=30)}segmentChanged(t){this.cdr.detectChanges(),this.segment=t.detail.value}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(f.F0),e.Y36(l.qu),e.Y36(T.e),e.Y36(w.B),e.Y36(c.yF),e.Y36(c.HT),e.Y36(P.E),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-login"]],decls:20,vars:5,consts:[[3,"fullscreen"],[1,"top","h-100"],[1,"main"],[1,"h-100"],[1,"header","text-center"],["src","assets\\img\\group.png","alt","logo",1,""],[1,"container","p-0"],[1,"container_sub"],[1,"form"],["value","user","id","segment",3,"ionChange"],["value","user",1,"heading"],[3,"ngClass"],["value","otp",1,"heading"],["class","form_main",4,"ngIf"],["src","assets/img/footer_img.png",1,"footer_img"],[1,"form_main"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group"],["for","username",1,"form_label"],[1,"glyphicon","glyphicon-user"],[1,"col-12","d-flex","align-items-center"],["src","assets/icon/user.svg",1,"icon"],["type","text","formControlName","username","id","username","placeholder","Enter Username","name","username",1,"form-control"],[1,"hr"],["for","password",1,"form_label"],["slot","start","src","assets/icon/padlock.svg","alt","",1,"icon"],["id","password","formControlName","password","placeholder","Enter password","name","password",1,"form-control",3,"type"],["slot","end",2,"color","#000",3,"name","click"],[1,"col-12","d-flex","align-items-center","justify-content-between"],["labelPlacement","end","formControlName","rememberMe",1,"remember","mb-2"],["routerLink","/forgot-pwd",1,"fgt_pwd"],["id","loginBtn","color","success","type","submit",1,"btn_login",3,"disabled"],[1,"span_login"],["for","phone",1,"form_label"],["src","assets/icon/phone.svg",1,"icon"],["type","number","formControlName","phone","id","phone","placeholder","Enter Phone","name","phone",1,"form-control",3,"input"],["color","success","name","checkmark-circle-sharp",4,"ngIf"],["for","otp",1,"form_label"],["src","assets/icon/padlock.svg",1,"icon"],["type","number","id","otp","formControlName","otp","placeholder","Enter OTP","name","otp","oninput","this.value = this.value.slice(0, 6)",1,"form-control"],["class","fgt_pwd",3,"click",4,"ngIf"],["class","fgt_pwd",3,"ngStyle",4,"ngIf"],["color","success","type","submit",1,"btn_login",3,"disabled"],["color","success","name","checkmark-circle-sharp"],[1,"fgt_pwd",3,"click"],[1,"fgt_pwd",3,"ngStyle"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"ion-img",5),e.qZA(),e.TgZ(6,"div",6)(7,"div",7)(8,"div",8)(9,"ion-segment",9),e.NdJ("ionChange",function(s){return n.segmentChanged(s)}),e.TgZ(10,"ion-segment-button",10)(11,"ion-label",11),e._uU(12,"Login Via User ID"),e.qZA()(),e.TgZ(13,"ion-segment-button",12)(14,"ion-label",11),e._uU(15,"Login Via OTP"),e.qZA()()(),e.YNc(16,Z,28,4,"div",13)(17,O,23,5,"div",13),e.qZA()(),e.TgZ(18,"div"),e._UZ(19,"ion-img",14),e.qZA()()()()()()),2&o&&(e.Q6J("fullscreen",!0),e.xp6(11),e.Q6J("ngClass","user"==n.segment?"text-color":""),e.xp6(3),e.Q6J("ngClass","otp"==n.segment?"text-color":""),e.xp6(2),e.Q6J("ngIf","user"===n.segment),e.xp6(),e.Q6J("ngIf","otp"===n.segment))},dependencies:[p.mk,p.O5,p.PC,l._Y,l.Fj,l.wV,l.JJ,l.JL,c.YG,c.nz,c.W2,c.gu,c.Xz,c.Q$,c.cJ,c.GO,c.w,c.QI,c.YI,l.sg,l.u,f.rH],styles:[".top[_ngcontent-%COMP%]{background-color:#fff}.main[_ngcontent-%COMP%]{background-color:#3553a1}.rectangle[_ngcontent-%COMP%]{border:1px solid}.header[_ngcontent-%COMP%]{padding:10vw}.container[_ngcontent-%COMP%]{border-radius:8vw 8vw 0 0;background-color:#fff}.container_sub[_ngcontent-%COMP%]{padding:8vw}.form[_ngcontent-%COMP%]{border-radius:2vw;background-color:#fff;box-shadow:0 2vw 4vw #0003,0 3vw 10vw #00000030}.heading[_ngcontent-%COMP%]{color:#000;font-family:Inter,sans-serif;font-weight:400;font-size:3vw;text-align:center;text-transform:capitalize}.text-color[_ngcontent-%COMP%]{color:#fff}.fgt_pwd[_ngcontent-%COMP%]{font-family:Inter,sans-serif;color:#3553a1;font-weight:900;margin-top:2vw;font-size:3vw}.remember[_ngcontent-%COMP%]{font-family:Inter,sans-serif;font-weight:400;margin-top:2vw;font-size:3vw;color:#000}.form_main[_ngcontent-%COMP%]{padding:1vw}.form_label[_ngcontent-%COMP%]{font-family:Inter,sans-serif;font-weight:400;font-size:3vw;color:#000}.form-control[_ngcontent-%COMP%]{border:none;font-family:Inter,sans-serif;font-weight:400;font-size:3vw;color:#9b9b9b}.hr[_ngcontent-%COMP%]{border:.2vw solid #d9d9d9;margin:0;height:0}.icon[_ngcontent-%COMP%]{height:3vw;width:3vw}input[_ngcontent-%COMP%]:focus{box-shadow:none}.btn_login[_ngcontent-%COMP%]{--border-radius: 1vw}.span_login[_ngcontent-%COMP%]{color:#fff;font-family:Inter,sans-serif;font-weight:700;font-size:3vw;text-transform:capitalize}.footer_img[_ngcontent-%COMP%]{width:60%;margin:auto}ion-segment[_ngcontent-%COMP%]{background-color:#fff}ion-segment-button.heading.md.in-segment.segment-button-has-label.segment-button-has-label-only.segment-button-checked.segment-button-layout-icon-top.ion-activatable.ion-activatable-instant.ion-focusable.hydrated[_ngcontent-%COMP%]{background-color:#3553a1;color:#fff}ion-segment-button.heading.ios.in-segment.segment-button-has-label.segment-button-has-label-only.segment-button-checked.segment-button-layout-icon-top.ion-activatable.ion-activatable-instant.ion-focusable.hydrated[_ngcontent-%COMP%]{background-color:#3553a1;color:#fff}@media screen and (max-width: 768px){.header[_ngcontent-%COMP%]{padding:15vw 10vw;width:80%;margin:auto}.container_sub[_ngcontent-%COMP%]{padding:8vw}.form_main[_ngcontent-%COMP%]{padding:2vw 4vw}}"]})}return i})()}];let L=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[f.Bz.forChild(M),f.Bz]})}return i})(),F=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#n=this.\u0275inj=e.cJS({imports:[p.ez,l.u5,c.Pc,l.UX,L]})}return i})()}}]);